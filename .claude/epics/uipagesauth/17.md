---
name: Database Schema & API Extensions
status: open
created: 2025-09-13T16:01:58Z
updated: 
github: https://github.com//issues/17
depends_on: []
parallel: true
conflicts_with: []
---

# Task: Database Schema & API Extensions

## Description
Extend the database schema with recipes table and enhance inventory movement tracking. Create comprehensive tRPC routers for inventory management, reporting, and recipe functionality to support the UI pages.

## Acceptance Criteria
- [ ] Recipes table created with ingredients and process steps schema
- [ ] Inventory movement tracking enhanced with better audit trail
- [ ] tRPC routers implemented for inventory, reports, and recipes
- [ ] All API endpoints properly typed and validated with Zod schemas
- [ ] Database migrations generated and tested

## Technical Details
Implementation approach:
- Add recipes table with foreign key relationships to existing entities
- Enhance inventory movements with better tracking and validation
- Create tRPC routers following existing patterns in packages/api
- Implement proper Zod validation for all input/output schemas
- Generate Drizzle migrations for schema changes

Key files affected:
- `packages/db/schema/recipes.ts` - New recipes schema
- `packages/db/schema/inventory.ts` - Enhanced inventory schema
- `packages/api/src/router/inventory.ts` - Inventory management router
- `packages/api/src/router/reports.ts` - Reporting router
- `packages/api/src/router/recipes.ts` - Recipe management router
- `packages/db/migrations/` - New migration files

## Dependencies
- [ ] Existing database schema and migrations up to date
- [ ] tRPC and Zod packages properly configured
- [ ] Database connection working for development and testing
- [ ] Drizzle ORM schema generation tools available

## Effort Estimate
- Size: L
- Hours: 12-16
- Parallel: true

## Definition of Done
- [ ] All acceptance criteria met and tested
- [ ] Database schema changes properly migrated and seeded
- [ ] All tRPC routers working with proper type safety
- [ ] API endpoints validated with comprehensive Zod schemas
- [ ] Database tests passing for all new functionality
- [ ] Code follows existing patterns and conventions in the monorepo
