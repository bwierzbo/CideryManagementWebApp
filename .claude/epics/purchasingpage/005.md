---
title: COGS Calculation Updates
created: 2025-09-14T01:14:26Z
epic: purchasingpage
depends_on: [001, 002, 003]
effort: M
hours: 16
parallel: true
---

# COGS Calculation Updates

## Description
Handle optional weight/cost values in existing cost rollup logic without breaking functionality

## Acceptance Criteria
- [ ] Update COGS calculation functions to handle null weight/cost values
- [ ] Maintain accurate cost allocation for mixed free/paid purchases
- [ ] Preserve existing COGS reporting functionality
- [ ] Add unit tests for null value scenarios
- [ ] Validate cost rollup accuracy with free apple scenarios
- [ ] Integration testing with golden path (purchase → press → batch → package)

## Technical Details
Update existing COGS functions in packages/lib, null value handling

## Dependencies
[001, 002, 003] (requires schema, migration, and unit conversion)

## Effort
Medium (M), 16 hours, parallel: true