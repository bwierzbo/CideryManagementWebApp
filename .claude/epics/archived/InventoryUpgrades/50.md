---
name: Database Schema Extension - Add material_type enum and metadata field to inventory/purchase tables
status: open
created: 2025-09-19T15:00:40Z
updated: 2025-09-19T15:18:17Z
github: https://github.com/bwierzbo/CideryManagementWebApp/issues/50
depends_on: []
parallel: true
conflicts_with: []
---

# Task: Database Schema Extension - Add material_type enum and metadata field to inventory/purchase tables

## Description
Extend the database schema to support different types of inventory items beyond just apples. Add a material_type enum to categorize items as apple, additive, juice, or packaging materials. Add a metadata JSONB field to store type-specific properties for flexible data storage.

## Acceptance Criteria
- [ ] material_type enum created with values: 'apple', 'additive', 'juice', 'packaging'
- [ ] metadata JSONB field added to relevant tables
- [ ] Migration script created and tested
- [ ] Drizzle schema updated in packages/db/src/schema.ts
- [ ] All existing data migrated without loss
- [ ] Database queries work with new schema

## Technical Details
- Implementation approach: Create new migration file with enum definition and ALTER TABLE statements
- Files affected:
  - packages/db/migrations/[timestamp]_add_material_type_and_metadata.sql
  - packages/db/src/schema.ts
  - packages/db/src/seed.ts (update seed data)
- Add material_type column with NOT NULL constraint and default value
- Add metadata JSONB column with default empty object {}
- Update TypeScript types to reflect schema changes

## Dependencies
- [ ] No dependencies - can be implemented independently

## Effort Estimate
- Size: M
- Hours: 8
- Parallel: true

## Definition of Done
- [ ] Code implemented
- [ ] Tests written and passing
- [ ] Migration tested on development database
- [ ] Drizzle schema generates correctly
- [ ] Seed data updated to include material types
- [ ] No breaking changes to existing functionality
