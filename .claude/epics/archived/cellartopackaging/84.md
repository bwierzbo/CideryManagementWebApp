---
name: QA Updates and Export
status: completed
created: 2025-09-26T14:09:32Z
updated: 2025-09-26T19:00:00Z
github: https://github.com/bwierzbo/CideryManagementWebApp/issues/84
depends_on: [80, 83]
parallel: false
conflicts_with: []
---

# Task: QA Updates and Export

## Description
Add quality assurance field update functionality to packaging runs and implement comprehensive CSV/PDF export capabilities for packaging data. This enables operators to update QA measurements post-packaging and generate reports for compliance and record-keeping.

## Acceptance Criteria
- [ ] QA field update modal/form on packaging detail page
- [ ] Edit QA measurements: ABV, pH, specific gravity, carbonation levels
- [ ] Add tasting notes, approval status, quality grade fields
- [ ] Input validation for QA measurement ranges and formats
- [ ] Save QA updates with proper audit trail logging
- [ ] CSV export for packaging runs list with all fields
- [ ] PDF export for individual packaging run details (production report format)
- [ ] Export filtering respects current list page filters
- [ ] Batch export functionality for multiple selected runs
- [ ] Export progress indicators for large datasets
- [ ] Email export option for PDF reports
- [ ] Permission checks for QA updates (Quality Manager/Admin roles)

## Technical Details
- Extend packaging API router with updateQA mutation
- Create QA update form component using React Hook Form + Zod validation
- Implement CSV export using appropriate library (csv-writer or similar)
- Create PDF generation using jsPDF or similar for professional reports
- Add export buttons to packaging list page and detail page
- Implement proper error handling for export operations
- Use background jobs for large exports to prevent timeout
- Include QA measurement history tracking in database updates
- Follow existing modal/form patterns from other detail pages
- Implement proper TypeScript types for QA update schemas
- Add export functionality to packages/worker for background processing
- Include email delivery capability for PDF reports

## Dependencies
- [ ] Task 80 (Packaging API Router) completed for base mutations
- [ ] Task 83 (Packaging Detail View) completed for UI integration
- [ ] Worker package available for background export jobs
- [ ] Email service configuration for PDF delivery

## Effort Estimate
- Size: XL
- Hours: 10-12 hours
- Parallel: false (depends on 80 and 83)

## Definition of Done
- [ ] Code implemented
- [ ] QA update functionality works correctly
- [ ] Input validation prevents invalid QA data entry
- [ ] CSV export generates properly formatted files
- [ ] PDF export creates professional-looking reports
- [ ] Export filtering works with list page filters
- [ ] Background export jobs process without timeout
- [ ] Permission checks prevent unauthorized QA updates
- [ ] Audit logging captures all QA changes
- [ ] Email delivery functions for PDF reports
- [ ] Error handling covers all export scenarios
- [ ] Tests written and passing for all functionality
- [ ] Code reviewed