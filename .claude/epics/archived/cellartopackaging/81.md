---
name: Cellar Modal UI
status: completed
created: 2025-09-26T14:09:32Z
updated: 2025-09-26T16:30:00Z
github: https://github.com/bwierzbo/CideryManagementWebApp/issues/81
depends_on: [79, 80]
parallel: false
conflicts_with: []
---

# Task: Cellar Modal UI

## Description
Add a "Bottle" button to vessel cards on the /cellar page and implement a modal interface for creating packaging runs from cellar batches. The modal should provide an intuitive interface for selecting package sizes, quantities, and creating packaging runs.

## Acceptance Criteria
- [ ] "Bottle" button added to vessel cards on /cellar page
- [ ] Modal opens when "Bottle" button is clicked
- [ ] Modal displays batch information (name, volume, ABV)
- [ ] Package size selection dropdown populated from package_sizes table
- [ ] Quantity input with validation against available batch volume
- [ ] Calculate and display total packages that will be created
- [ ] Form validation prevents over-packaging (quantity > available volume)
- [ ] Success state redirects to packaging runs list or shows confirmation
- [ ] Error handling for API failures
- [ ] Modal can be closed/cancelled without making changes

## Technical Details
- Add "Bottle" button to existing vessel card component in apps/web/src/components/
- Create PackagingModal component using shadcn/ui Dialog component
- Implement form using React Hook Form with Zod validation
- Use tRPC packaging.createFromCellar mutation from task 80
- Use tRPC packaging.getPackageSizes query for package size options
- Follow existing modal patterns from the codebase
- Include loading states during API calls
- Implement proper error boundary handling
- Ensure modal is accessible (keyboard navigation, screen readers)

## Dependencies
- [ ] Task 79 (Package Sizes Reference Data) completed
- [ ] Task 80 (Packaging API Router) completed
- [ ] Existing /cellar page and vessel card components available

## Effort Estimate
- Size: M
- Hours: 4-5 hours
- Parallel: false (depends on 79, 80)

## Definition of Done
- [ ] Code implemented
- [ ] Component tests written and passing
- [ ] Integration tests verify modal behavior
- [ ] Form validation works correctly
- [ ] API integration functions properly
- [ ] UI/UX follows existing design patterns
- [ ] Accessibility requirements met
- [ ] Code reviewed