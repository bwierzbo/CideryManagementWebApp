---
name: Database Analysis - Schema-to-code mapping and usage scanning
status: open
created: 2025-09-28T20:37:25Z
updated: 2025-09-28T20:48:49Z
github: https://github.com/bwierzbo/CideryManagementWebApp/issues/88
depends_on: [89]  # Depends on Code Analysis completion
parallel: true  # Can run in parallel with other analysis tasks
conflicts_with: []  # No conflicts
---

# Task: Database Analysis - Schema-to-code mapping and usage scanning

## Description
Build comprehensive schema-to-code mapping using Drizzle introspection and create database usage scanner with AST parsing to identify unused tables, columns, and indexes. Generate database drift analysis report to identify gaps between schema definitions and actual usage.

## Acceptance Criteria
- [ ] Schema-to-code mapping tool built using Drizzle introspection
- [ ] Database usage scanner implemented with AST parsing
- [ ] Unused tables identified and catalogued
- [ ] Unused columns identified per table
- [ ] Unused indexes identified and analyzed
- [ ] Database drift analysis report generated
- [ ] Performance impact assessment for unused elements
- [ ] Integration with existing codebase analysis from task 001

## Technical Details
- Create `scripts/database-analysis.ts` for schema introspection
- Implement AST parser to scan TypeScript files for database usage
- Use Drizzle's introspection capabilities to map schema to actual usage
- Cross-reference with query analysis from static code analysis
- Generate reports in JSON and markdown formats
- Identify foreign key constraints on unused columns
- Analyze index usage patterns and query performance impact

## Dependencies
- [ ] Task 001 (Code Analysis) completed for cross-referencing
- [ ] Drizzle ORM schema introspection available
- [ ] Database connection for runtime analysis
- [ ] AST parsing tools (typescript compiler API)

## Effort Estimate
- Size: L
- Hours: 8-12 hours
- Parallel: true

## Definition of Done
- [ ] Schema mapping tool implemented and tested
- [ ] Database usage scanner functional across all packages
- [ ] Comprehensive report of unused database elements
- [ ] Performance impact analysis completed
- [ ] Documentation for database cleanup recommendations
- [ ] Integration tests verify accuracy of analysis
- [ ] Tool can be run as part of CI pipeline
