---
name: Additive Tracking System
status: open
created: 2025-09-17T05:27:36Z
updated: 2025-09-17T05:27:36Z
github: [Will be updated when synced to GitHub]
depends_on: [2, 3]  # Both depend on status management and API integration
parallel: true  # Can run in parallel with measurement recording
conflicts_with: []
---

# Task: Additive Tracking System

## Description
Build comprehensive additive tracking system for cellar tank management, including forms for recording additive additions (sulfites, nutrients, enzymes, etc.), validation rules for dosage calculations, and complete history timeline showing all additives applied to vessels and batches over time.

## Acceptance Criteria
- [ ] Additive recording form with support for various additive types (sulfites, nutrients, enzymes, fining agents, custom)
- [ ] Dosage calculation validation based on vessel volume and additive concentration
- [ ] API endpoints for creating, updating, and retrieving additive records
- [ ] Complete additive history timeline with chronological view
- [ ] Additive inventory tracking and depletion warnings
- [ ] Integration with vessel/batch context for proper association
- [ ] Additive templates for common treatments
- [ ] Batch additive summary and total calculations
- [ ] Search and filtering of additive history
- [ ] Export functionality for additive reports

## Technical Details
- Create additive schema in packages/db with proper relationships
- Build tRPC procedures in packages/api for additive operations
- Implement React components in apps/web for additive forms and timeline
- Create additive calculation logic in packages/lib for dosage validation
- Use TanStack Query for real-time updates and optimistic UI
- Integrate with existing vessel and batch management systems
- Implement timeline component for chronological additive history
- Add inventory tracking for additive supplies

## Dependencies
- [ ] Task 002: Vessel Status Management System (for vessel context)
- [ ] Task 003: Vessel API Integration (for data layer)
- [ ] Existing vessel and batch schemas
- [ ] Authentication and authorization system
- [ ] Reference data system for additive types

## Effort Estimate
- Size: L
- Hours: 18-22 hours
- Parallel: true

## Definition of Done
- [ ] Code implemented and integrated with existing vessel system
- [ ] Comprehensive tests written and passing
- [ ] Dosage calculation logic tested with various scenarios
- [ ] API endpoints tested with validation rules
- [ ] UI components tested for usability and accuracy
- [ ] Timeline component displays chronological history correctly
- [ ] Inventory tracking functionality works
- [ ] Export functionality generates accurate reports
- [ ] Documentation updated
- [ ] Code reviewed and approved