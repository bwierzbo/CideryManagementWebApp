---
name: Database Schema Updates - Extend vessel status enum and create measurement/additive tables
status: open
created: 2025-09-17T05:27:36Z
updated: 2025-09-17T05:27:36Z
github: [Will be updated when synced to GitHub]
depends_on: []  # No dependencies - foundation task
parallel: true  # Can run in parallel with task 003
conflicts_with: []  # No conflicts
---

# Task: Database Schema Updates - Extend vessel status enum and create measurement/additive tables

## Description
Extend the existing database schema to support cellar tank functionality by updating vessel status enums and creating new tables for measurements and additives. This provides the foundation for tank status management and tracking tank-specific operations.

## Acceptance Criteria
- [ ] Vessel status enum extended with tank-specific statuses (cleaning, sanitizing, filling, fermenting, conditioning, transferring, empty)
- [ ] Measurement table created with fields for vessel_id, measurement_type, value, unit, timestamp, notes
- [ ] Additive table created with fields for vessel_id, additive_type, amount, unit, timestamp, notes, batch_reference
- [ ] Database migration files generated and tested
- [ ] Schema changes validated with existing data
- [ ] Drizzle ORM types updated

## Technical Details
- Extend `packages/db/src/schema/vessels.ts` vessel status enum
- Create new measurement and additive tables in appropriate schema files
- Generate migration files using `pnpm db:generate`
- Test migrations against seed data
- Update TypeScript types for new fields
- Ensure foreign key relationships are properly defined

## Dependencies
- [ ] PostgreSQL database running
- [ ] Drizzle ORM configuration verified

## Effort Estimate
- Size: M
- Hours: 4-6 hours
- Parallel: true

## Definition of Done
- [ ] Code implemented with proper schema definitions
- [ ] Migration files generated and tested
- [ ] Tests written for new schema components
- [ ] Database migrations run successfully
- [ ] TypeScript types compile without errors
- [ ] Code reviewed for schema best practices
