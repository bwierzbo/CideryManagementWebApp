<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Test Inline Edit</title>
  <script>
    async function testInlineEdit() {
      const testId = '66109f2d-663e-4662-b248-75038a0ca446';

      console.log('Testing inline editing API...');

      // Test updating fruitType
      console.log('\n1. Testing fruitType update (apple -> pear)...');
      try {
        const response = await fetch(`/api/trpc/fruitVariety.update?batch=1&input=${encodeURIComponent(JSON.stringify({
          '0': { id: testId, patch: { fruitType: 'pear' } }
        }))}`);
        const data = await response.json();
        if (response.ok && data[0]?.result?.data?.success) {
          console.log('✅ fruitType update successful');
        } else {
          console.error('❌ Failed:', data[0]?.error || 'Unknown error');
        }
      } catch (e) {
        console.error('❌ Error:', e);
      }

      // Test updating ciderCategory
      console.log('\n2. Testing ciderCategory update (null -> sweet)...');
      try {
        const response = await fetch(`/api/trpc/fruitVariety.update?batch=1&input=${encodeURIComponent(JSON.stringify({
          '0': { id: testId, patch: { ciderCategory: 'sweet' } }
        }))}`);
        const data = await response.json();
        if (response.ok && data[0]?.result?.data?.success) {
          console.log('✅ ciderCategory update successful');
        } else {
          console.error('❌ Failed:', data[0]?.error || 'Unknown error');
        }
      } catch (e) {
        console.error('❌ Error:', e);
      }

      // Test updating to null
      console.log('\n3. Testing null update (sweet -> null)...');
      try {
        const response = await fetch(`/api/trpc/fruitVariety.update?batch=1&input=${encodeURIComponent(JSON.stringify({
          '0': { id: testId, patch: { ciderCategory: null } }
        }))}`);
        const data = await response.json();
        if (response.ok && data[0]?.result?.data?.success) {
          console.log('✅ null update successful');
        } else {
          console.error('❌ Failed:', data[0]?.error || 'Unknown error');
        }
      } catch (e) {
        console.error('❌ Error:', e);
      }

      // Restore original
      console.log('\n4. Restoring original values...');
      try {
        const response = await fetch(`/api/trpc/fruitVariety.update?batch=1&input=${encodeURIComponent(JSON.stringify({
          '0': { id: testId, patch: { fruitType: 'apple' } }
        }))}`);
        const data = await response.json();
        if (response.ok && data[0]?.result?.data?.success) {
          console.log('✅ Restore successful');
        } else {
          console.error('❌ Failed:', data[0]?.error || 'Unknown error');
        }
      } catch (e) {
        console.error('❌ Error:', e);
      }

      console.log('\n✅ All tests complete! Check the Fruits page to see if inline editing works in the UI.');
    }

    // Run test on page load
    window.addEventListener('load', testInlineEdit);
  </script>
</head>
<body>
  <h1>Testing Inline Edit API</h1>
  <p>Check the browser console for test results.</p>
  <button onclick="testInlineEdit()">Run Tests Again</button>
</body>
</html>